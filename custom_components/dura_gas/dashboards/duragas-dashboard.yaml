# DuraGas Dashboard - Complete Configuration
# Generated: 2025-12-22
# Version: 1.0.0
#
# USAGE OPTIONS:
#
# Option 1: Full Dashboard (paste in raw config editor for a new dashboard)
#   Use the entire file including "views:" section
#
# Option 2: Single Card (paste in a card slot on existing dashboard)
#   Use only the content starting from "type: vertical-stack" below
#
# NAVIGATION NOTE:
# Both views (duragas and duragas-analytics) are in the same dashboard.
# Navigation paths use the view path only, prefixed with the dashboard URL.
# Example: If your dashboard URL is /lovelace-gas, navigation would be:
#   /lovelace-gas/duragas-analytics
#
# After importing, update DASHBOARD_URL below to match your dashboard URL:
# =============================================================================

views:
  - title: DuraGas
    path: duragas
    icon: mdi:propane-tank
    cards:
      - type: vertical-stack
        cards:
          # ===========================================
          # Section 1: Header with Analytics Link
          # ===========================================
          - type: horizontal-stack
            cards:
              - type: markdown
                content: |
                  # üî• DuraGas - Monitor de Gas LP
                  ### *Que tu gas dure m√°s*
              - type: button
                name: Analytics
                icon: mdi:chart-box
                icon_height: 40px
                tap_action:
                  action: navigate
                  navigation_path: duragas-analytics

          # ===========================================
          # Section 2: Quick Stats Glance
          # ===========================================
          - type: glance
            entities:
              - entity: sensor.duragas_tank_monitor_tank_level
                name: Nivel
                icon: mdi:propane-tank
              - entity: sensor.duragas_tank_monitor_days_remaining
                name: D√≠as Restantes
                icon: mdi:calendar-clock
              - entity: sensor.duragas_tank_monitor_tank_value
                name: Valor
                icon: mdi:cash
            columns: 3
            show_name: true
            show_state: true
            show_icon: true

          # ===========================================
          # Section 3: Main Tank Level Gauge
          # ===========================================
          - type: gauge
            entity: sensor.duragas_tank_monitor_tank_level
            name: Nivel del Tanque
            unit: "%"
            min: 0
            max: 100
            needle: true
            severity:
              green: 50
              yellow: 30
              red: 0

          # ===========================================
          # Section 4: Current Tank Status
          # ===========================================
          - type: entities
            title: "üìä Estado Actual del Tanque"
            entities:
              - entity: sensor.duragas_tank_monitor_tank_level
                name: Nivel del Tanque
                icon: mdi:propane-tank
              - entity: sensor.duragas_tank_monitor_tank_liters
                name: Litros en Tanque
                icon: mdi:water
              - entity: sensor.duragas_tank_monitor_tank_kilograms
                name: Kilogramos en Tanque
                icon: mdi:weight-kilogram
              - entity: sensor.duragas_tank_monitor_tank_value
                name: Valor del Gas
                icon: mdi:cash

          # ===========================================
          # Section 5: Quick Actions - Main Buttons
          # ===========================================
          - type: markdown
            content: |
              ## ‚ö° Acciones R√°pidas

          - type: entities
            title: "‚õΩ Registrar Recarga"
            entities:
              - entity: number.duragas_tank_monitor_refill_liters_input
                name: Litros a Recargar
              - entity: number.duragas_tank_monitor_price_per_liter_input
                name: Precio por Litro

          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: Registrar Recarga
                icon: mdi:gas-station
                styles:
                  card:
                    - height: 80px
                  icon:
                    - width: 40px
                    - height: 40px
                tap_action:
                  action: call-service
                  service: dura_gas.record_refill
                  service_data:
                    liters: "[[[ return parseFloat(states['number.duragas_tank_monitor_refill_liters_input'].state) ]]]"
                    price_per_liter: "[[[ return parseFloat(states['number.duragas_tank_monitor_price_per_liter_input'].state) ]]]"
                  confirmation:
                    text: |
                      [[[
                        const liters = parseFloat(states['number.duragas_tank_monitor_refill_liters_input'].state);
                        const price = parseFloat(states['number.duragas_tank_monitor_price_per_liter_input'].state);
                        const total = (liters * price).toFixed(2);
                        return `¬øRegistrar recarga de ${liters}L a $${price}/L?\n\nTotal: $${total} MXN`;
                      ]]]

              - type: custom:button-card
                name: Actualizar Precio
                icon: mdi:currency-usd
                styles:
                  card:
                    - height: 80px
                  icon:
                    - width: 40px
                    - height: 40px
                tap_action:
                  action: call-service
                  service: dura_gas.update_price
                  service_data:
                    price_per_liter: "[[[ return parseFloat(states['number.duragas_tank_monitor_price_per_liter_input'].state) ]]]"
                  confirmation:
                    text: |
                      [[[
                        const price = parseFloat(states['number.duragas_tank_monitor_price_per_liter_input'].state);
                        return `¬øActualizar precio a $${price}/L?`;
                      ]]]

          # ===========================================
          # Section 6: Quick Level Update Buttons
          # ===========================================
          - type: horizontal-stack
            cards:
              - type: button
                name: "75%"
                icon: mdi:gauge-full
                icon_height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.update_level
                  data:
                    level_percent: 75
                  confirmation:
                    text: "¬øEstablecer nivel al 75%?"

              - type: button
                name: "50%"
                icon: mdi:gauge
                icon_height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.update_level
                  data:
                    level_percent: 50
                  confirmation:
                    text: "¬øEstablecer nivel al 50%?"

              - type: button
                name: "25%"
                icon: mdi:gauge-low
                icon_height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.update_level
                  data:
                    level_percent: 25
                  confirmation:
                    text: "¬øEstablecer nivel al 25%?"

          # ===========================================
          # Section 7: Consumption Analysis
          # ===========================================
          - type: entities
            title: "üìà An√°lisis de Consumo"
            entities:
              - entity: sensor.duragas_tank_monitor_daily_consumption
                name: Consumo Diario
                icon: mdi:fire
              - entity: sensor.duragas_tank_monitor_monthly_consumption
                name: Consumo Mensual
                icon: mdi:calendar-month
              - entity: sensor.duragas_tank_monitor_days_since_refill
                name: D√≠as Desde √öltima Recarga
                icon: mdi:calendar-clock
              - entity: sensor.duragas_tank_monitor_liters_consumed
                name: Litros Consumidos
                icon: mdi:counter

          # ===========================================
          # Section 8: Projections
          # ===========================================
          - type: entities
            title: "üîÆ Proyecciones"
            entities:
              - entity: sensor.duragas_tank_monitor_days_remaining
                name: D√≠as Restantes
                icon: mdi:calendar-arrow-right
              - entity: sensor.duragas_tank_monitor_weeks_remaining
                name: Semanas Restantes
                icon: mdi:calendar-week
              - entity: sensor.duragas_tank_monitor_next_refill_date
                name: Fecha Pr√≥xima Recarga
                icon: mdi:calendar-alert

          # ===========================================
          # Section 9: Current Recommendation
          # ===========================================
          - type: markdown
            title: "üí° Recomendaci√≥n de Recarga"
            content: |
              **Litros Recomendados:** {{ states('sensor.duragas_tank_monitor_recommended_liters') | round(1) }} L

              **Costo Estimado:** ${{ states('sensor.duragas_tank_monitor_recommended_cost') | round(2) }} MXN

              **Nivel Resultante:** {{ states('sensor.duragas_tank_monitor_resulting_level') | round(1) }}%

              ---
              *Basado en tu estrategia de recarga actual*

          # ===========================================
          # Section 10: Last Refill Information
          # ===========================================
          - type: entities
            title: "‚õΩ √öltima Recarga"
            entities:
              - entity: sensor.duragas_tank_monitor_last_refill_date
                name: Fecha
                icon: mdi:calendar-check
              - entity: sensor.duragas_tank_monitor_last_refill_liters
                name: Litros
                icon: mdi:gas-station
              - entity: sensor.duragas_tank_monitor_last_refill_cost
                name: Costo Total
                icon: mdi:cash

          # ===========================================
          # Section 11: Cost Analysis
          # ===========================================
          - type: entities
            title: "üí∞ An√°lisis de Costos"
            entities:
              - entity: sensor.duragas_tank_monitor_monthly_cost
                name: Costo Mensual Proyectado
                icon: mdi:cash-multiple
              - entity: sensor.duragas_tank_monitor_refills_per_month
                name: Recargas por Mes
                icon: mdi:counter
              - entity: sensor.duragas_tank_monitor_savings_vs_cylinders
                name: Ahorro vs Cilindros
                icon: mdi:piggy-bank

          # ===========================================
          # Section 12: Alerts
          # ===========================================
          - type: entities
            title: "üö® Alertas"
            entities:
              - entity: binary_sensor.duragas_tank_monitor_low_level
                name: Nivel Bajo
                icon: mdi:alert-circle
              - entity: binary_sensor.duragas_tank_monitor_refill_recommended
                name: Recarga Recomendada
                icon: mdi:gas-station-outline

          # ===========================================
          # Section 13: Historical Graph
          # ===========================================
          - type: history-graph
            title: "üìâ Historial de Nivel (7 d√≠as)"
            entities:
              - entity: sensor.duragas_tank_monitor_tank_level
                name: Nivel del Tanque
            hours_to_show: 168
            refresh_interval: 300

          # ===========================================
          # Section 14: Additional Actions
          # ===========================================
          - type: markdown
            content: |
              ## ‚öôÔ∏è Configuraci√≥n Avanzada

          - type: horizontal-stack
            cards:
              - type: custom:button-card
                name: Recarga R√°pida 50L
                icon: mdi:gas-station-outline
                styles:
                  card:
                    - height: 60px
                  icon:
                    - width: 30px
                    - height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.record_refill
                  service_data:
                    liters: 50
                    price_per_liter: "[[[ return parseFloat(states['number.duragas_tank_monitor_price_per_liter_input'].state) ]]]"
                  confirmation:
                    text: |
                      [[[
                        const price = parseFloat(states['number.duragas_tank_monitor_price_per_liter_input'].state);
                        const total = (50 * price).toFixed(2);
                        return `¬øRegistrar recarga de 50L a $${price}/L?\n\nTotal: $${total} MXN`;
                      ]]]

              - type: button
                name: Llenar Completo
                icon: mdi:propane-tank
                icon_height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.update_level
                  data:
                    level_percent: 80
                  confirmation:
                    text: "¬øEstablecer nivel al 80% (tanque lleno)?"

          - type: horizontal-stack
            cards:
              - type: button
                name: Estrategia Completa
                icon: mdi:checkbox-marked-circle
                icon_height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.set_strategy
                  data:
                    strategy: fill_complete
                  confirmation:
                    text: "¬øCambiar estrategia a 'Llenar Completo'?"

              - type: button
                name: Estrategia $500
                icon: mdi:cash-check
                icon_height: 30px
                tap_action:
                  action: call-service
                  service: dura_gas.set_strategy
                  data:
                    strategy: fixed_500
                  confirmation:
                    text: "¬øCambiar estrategia a 'Monto Fijo $500'?"

          # ===========================================
          # Section 15: Footer
          # ===========================================
          - type: markdown
            content: |
              ---
              *DuraGas v0.1.0-dev.0 | Tanque: 120L | Actualizaci√≥n: cada 5 min*

  # =============================================================================
  # ANALYTICS VIEW
  # =============================================================================
  - title: Analytics
    path: duragas-analytics
    icon: mdi:chart-box
    type: panel
    cards:
      - type: vertical-stack
        cards:
          # Header with Back Button
          - type: horizontal-stack
            cards:
              - type: markdown
                content: |
                  # Analisis Historico DuraGas
                  **Periodo:** Ultimos 6 meses

                  Monitoreo de consumo, precios y costos de gas LP a lo largo del tiempo.
              - type: button
                name: Volver
                icon: mdi:arrow-left
                icon_height: 40px
                tap_action:
                  action: navigate
                  navigation_path: duragas

          # Current Status Summary
          - type: horizontal-stack
            cards:
              - type: entity
                entity: sensor.duragas_tank_monitor_tank_level
                name: Nivel Actual
                icon: mdi:propane-tank
              - type: entity
                entity: sensor.duragas_tank_monitor_monthly_consumption
                name: Consumo Mensual
                icon: mdi:calendar-month
              - type: entity
                entity: sensor.duragas_tank_monitor_monthly_cost
                name: Costo Mensual
                icon: mdi:cash-multiple
              - type: entity
                entity: sensor.duragas_tank_monitor_savings_vs_cylinders
                name: Ahorro vs Cilindros
                icon: mdi:compare-horizontal

          # Monthly Consumption Trend
          - type: history-graph
            title: Consumo Mensual (L/mes)
            entities:
              - entity: sensor.duragas_tank_monitor_monthly_consumption
                name: Litros/mes
            hours_to_show: 4320
            refresh_interval: 3600

          # Price History
          - type: history-graph
            title: Precio del Gas LP (MXN/L)
            entities:
              - entity: sensor.duragas_tank_monitor_gas_price_history
                name: Precio por Litro
            hours_to_show: 4320
            refresh_interval: 3600

          # Monthly Cost
          - type: history-graph
            title: Gasto Mensual (MXN/mes)
            entities:
              - entity: sensor.duragas_tank_monitor_monthly_cost
                name: Costo Mensual
            hours_to_show: 4320
            refresh_interval: 3600

          # Tank Level History
          - type: history-graph
            title: Nivel del Tanque (%)
            entities:
              - entity: sensor.duragas_tank_monitor_tank_level
                name: Nivel
            hours_to_show: 4320
            refresh_interval: 3600

          # Savings vs Cylinders
          - type: history-graph
            title: Ahorro vs Cilindros (MXN/mes)
            entities:
              - entity: sensor.duragas_tank_monitor_savings_vs_cylinders
                name: Ahorro Mensual
            hours_to_show: 4320
            refresh_interval: 3600

          # Statistics Summary (90 days)
          - type: statistics-graph
            title: Estadisticas de Consumo (90 dias)
            entities:
              - sensor.duragas_tank_monitor_monthly_consumption
            days_to_show: 90
            stat_types:
              - mean
              - min
              - max

          # Daily Consumption Pattern
          - type: statistics-graph
            title: Patron de Consumo Diario (30 dias)
            entities:
              - sensor.duragas_tank_monitor_daily_consumption
            days_to_show: 30
            stat_types:
              - mean
              - min
              - max

          # Recent Refills Information
          - type: markdown
            content: |
              ## Ultimas Recargas

              | Dato | Valor |
              |------|-------|
              | Fecha ultima recarga | {{ states('sensor.duragas_tank_monitor_last_refill_date') }} |
              | Litros recargados | {{ states('sensor.duragas_tank_monitor_last_refill_liters') }} L |
              | Costo total | ${{ states('sensor.duragas_tank_monitor_last_refill_cost') }} MXN |
              | Dias desde recarga | {{ states('sensor.duragas_tank_monitor_days_since_refill') }} dias |

              ---

              ### Proyecciones

              | Dato | Valor |
              |------|-------|
              | Dias restantes | {{ states('sensor.duragas_tank_monitor_days_remaining') }} dias |
              | Proxima recarga | {{ states('sensor.duragas_tank_monitor_next_refill_date') }} |
              | Litros recomendados | {{ states('sensor.duragas_tank_monitor_recommended_liters') }} L |
              | Costo estimado | ${{ states('sensor.duragas_tank_monitor_recommended_cost') }} MXN |

          # Cost Comparison Card
          - type: entities
            title: Comparacion de Costos
            entities:
              - entity: sensor.duragas_tank_monitor_monthly_cost
                name: Costo Mensual Actual
                icon: mdi:cash
              - entity: sensor.duragas_tank_monitor_savings_vs_cylinders
                name: Ahorro vs Cilindros
                icon: mdi:piggy-bank
              - entity: sensor.duragas_tank_monitor_refills_per_month
                name: Recargas por Mes
                icon: mdi:counter

          # Cylinder Comparison Note
          - type: markdown
            content: |
              *Comparacion basada en costo de cilindros: $584 MXN/mes*

          # Usage Tips
          - type: markdown
            content: |
              ---
              ### Consejos de Uso

              - **Graficas historicas**: Los datos se acumulan con el tiempo. Las graficas seran mas utiles despues de algunas semanas de uso.
              - **Precio del gas**: Actualiza el precio cuando haya cambios usando el servicio `dura_gas.update_price`.
              - **Precision**: Registra cada recarga con `dura_gas.record_refill` para mejorar las proyecciones.
              - **Ahorro**: Un valor positivo en "Ahorro vs Cilindros" significa que estas ahorrando comparado con usar cilindros tradicionales.
